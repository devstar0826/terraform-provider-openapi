# <img src="http://goa.design/img/goa-logo.svg">

This example was created using [goa](https://goa.design/) framework. Using goa we have created a service provider that 
exposes a resource for managing 'Bottles' allowing the consumer to create and read bottles.

## Overview

goa is a framework for building micro-services and REST APIs in Go using a unique design-first approach.

This service provider APIs have been designed using goa's DSL and leveraging the goa framework the server, client,
swagger documentation and a CLI were generated automatically. This is where the real power of goa resides, allowing service
providers to focus on improving their services while still offering good integration capabilities.

The code containing the API design is located in the 'design' folder. This file contains all the information related to
the API from where goa will feed and generate the code desired (e,g: server api, client lib, documentation, cli, etc). In
this example, everything inside the api folder was autogenerated by goa excluding the design/design.go file.

## How to

If you want to play around with the code, feel free to jump into the following folder:

````
$ cd $GOPATH/github.com/dikhan/terraform-provider-openapi/examples/goa/api
````

From there, go ahead and remove all the folders/files excluding the design folder. Running the command below will
auto-generate the same contents again (make sure 'goagen' is installed as per [goa installation instructions](https://github.com/goadesign/goa/blob/master/README.md#installation)):

````
$ goagen bootstrap -d github.com/dikhan/terraform-provider-openapi/examples/goa/api/design
````

The above command will auto-generate the following folders/files based on the design.go file located at ```$GOPATH/github.com/dikhan/terraform-provider-openapi/examples/goa/api/design```:

````
app
app/contexts.go
app/controllers.go
app/hrefs.go
app/media_types.go
app/user_types.go
app/test
app/test/bottle_testing.go
main.go
bottle.go
tool/cellar-cli
tool/cellar-cli/main.go
tool/cli
tool/cli/commands.go
client
client/client.go
client/bottle.go
client/user_types.go
client/media_types.go
swagger
swagger/swagger.json
swagger/swagger.yaml
````

As you can see, goa can make you save a lot of time. The server side code, client library, API documentation and even a
CLI was created for free by ust running one command. The server side code generated handles all the things related 
to transport and connections, however the actual logic needs to be implemented by the service provider of course.

In this example, the auto-generated [bottle.go](https://github.com/dikhan/terraform-provider-openapi/tree/master/examples/goa/api/bottle.go) file has been updated to use an in-memory db (just a simple
map) so we are able to use the terraform-provider-openapi against the API and manage the resources created.


# Run the example

Build the container:
````
$ cd $GOPATH/github.com/dikhan/terraform-provider-openapi/examples/goa/api
$ docker build -t goa-service-provider-api .
````

Run the container:
````
docker run -p 9090:9090 goa-service-provider-api
````

